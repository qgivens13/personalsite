@page "/dadboard"
@using personalsite.Models
@using personalsite.Services
@using personalsite.Components
@inject IDadboardService DadboardService

<PageTitle>Dadboard - Dad Life Dashboard</PageTitle>

<div class="min-h-screen bg-[#1A1A1A] grid-background">
    <div class="container mx-auto px-4 py-12 max-w-7xl dadboard-container">
        
        <!-- Header -->
        <div class="mb-12">
            <div class="flex items-center gap-3 mb-4">
                <h1 class="text-4xl md:text-5xl font-bold text-white tracking-tight">
                    Dadboard
                </h1>
                <span class="text-4xl">üë®‚Äçüëß‚Äçüë¶</span>
            </div>
            <p class="text-lg text-gray-400">
                Real-time dad life analytics and survival metrics
            </p>
        </div>

        @if (isLoading)
        {
            <div class="flex items-center justify-center py-20">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"></div>
            </div>
        }
        else if (data != null)
        {
            <!-- Stats Grid -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-white mb-6">Lifetime Statistics</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    @foreach (var stat in data.Stats)
                    {
                        <StatCard 
                            Title="@stat.Title"
                            Value="@stat.Value"
                            Unit="@stat.Unit"
                            Icon="@stat.Icon"
                            Trend="@stat.Trend"
                            TrendLabel="@stat.TrendLabel"
                        />
                    }
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                
                <!-- Donut Chart -->
                <DonutChart 
                    Title="Toddler Meltdowns by Category"
                    Categories="@data.Meltdowns"
                />

                <!-- Line Chart -->
                <LineChart 
                    Title="Hours of Sleep Per Night (Last 14 Days)"
                    DataPoints="@data.SleepData"
                />
            </div>

            <!-- Dad Wisdom Footer -->
            <div class="mt-12 bg-[#2A2A2A] border border-[#3A3A3A] rounded-lg p-6 text-center">
                <div class="text-lg text-gray-300 italic mb-2">
                    "Being a dad isn't about the stats... but they sure are impressive."
                </div>
                <div class="text-sm text-gray-500">
                    ‚Äî Every Dad, probably
                </div>
            </div>
        }
    </div>
</div>

@code {
    private DadboardData? data;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
    }

    private async Task LoadData()
    {
        isLoading = true;
        try
        {
            // Simulate a slight delay for smooth loading experience
            await Task.Delay(300);
            data = await DadboardService.GetDadboardDataAsync();
        }
        finally
        {
            isLoading = false;
        }
    }
}

